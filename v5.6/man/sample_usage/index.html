<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sample Usage · BTrDB.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../"><img class="logo" src="../../assets/logo.png" alt="BTrDB.jl logo"/></a><h1>BTrDB.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Introduction</a></li><li><span class="toctext">User Guide</span><ul><li><a class="toctext" href="../getting_started/">Getting Started</a></li><li><a class="toctext" href="../explained/">BTrDB Explained</a></li><li><a class="toctext" href="../concepts/">Concepts</a></li><li class="current"><a class="toctext" href>Sample Usage</a><ul class="internal"><li><a class="toctext" href="#Managing-Streams-1">Managing Streams</a></li><li><a class="toctext" href="#Querying-for-Streams-1">Querying for Streams</a></li><li><a class="toctext" href="#Managing-Stream-Data-1">Managing Stream Data</a></li><li><a class="toctext" href="#Querying-Stream-Data-1">Querying Stream Data</a></li></ul></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../../lib/types/">Types</a></li><li><a class="toctext" href="../../lib/functions/">Functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>User Guide</li><li><a href>Sample Usage</a></li></ul><a class="edit-page" href="https://github.com/PingThingsIO/BTrDB.jl/blob/master/docs/src/man/sample_usage.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Sample Usage</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Sample-Usage-1" href="#Sample-Usage-1">Sample Usage</a></h1><h2><a class="nav-anchor" id="Managing-Streams-1" href="#Managing-Streams-1">Managing Streams</a></h2><h3><a class="nav-anchor" id="Create-a-New-Stream-1" href="#Create-a-New-Stream-1">Create a New Stream</a></h3><p>To create a new stream so that you can insert points, you may use the <code>create</code> function.  There is some metadata that will be required including the UUID, collection, tags, and annotations.  Annotations is the only argument that is not required for creating a new stream.</p><pre><code class="language-julia">collection = &quot;zoo/animals&quot;
uuid_token = &quot;33ecd8fe-8942-5bd3-ad9f-b3e8165399ab&quot;
tags = Dict{String, String}(
    &quot;name&quot;      =&gt; &quot;liger&quot;,
    &quot;unit&quot;      =&gt; &quot;animal&quot;
)
annotations = Dict{String, Any}(
    &quot;phase&quot; =&gt; &quot;A&quot;
)

s = create(uuid_token, collection, tags, annotations)</code></pre><h3><a class="nav-anchor" id="Delete-a-Stream-1" href="#Delete-a-Stream-1">Delete a Stream</a></h3><p>Assuming you have the appropriate permissions, deleting a stream is straightforward using the <code>obliterate</code> function as shown below.</p><pre><code class="language-julia">uuid_token = &quot;33ecd8fe-8942-5bd3-ad9f-b3e8165399ae&quot;
obliterate(uuid_token)</code></pre><p>Many functions will allow you to use either the UUID or a Stream object as the input such as the example below:</p><pre><code class="language-julia">s = create(uuid_token, collection, tags, annotations)
obliterate(s)</code></pre><h2><a class="nav-anchor" id="Querying-for-Streams-1" href="#Querying-for-Streams-1">Querying for Streams</a></h2><h3><a class="nav-anchor" id="Collections-1" href="#Collections-1">Collections</a></h3><p>You can think of collections as the path to your individual streams.  Mutliple streams can live in a given collection and you can easily query for all available collections using the <code>collections</code> function.</p><pre><code class="language-julia">collections(&quot;&quot;)
2989-element Array{Any,1}:
 &quot;USGS/GEOMAG/Boulder&quot;
 &quot;USGS/GEOMAG/Barrow&quot;
 &quot;USGS/GEOMAG/Honolulu&quot;</code></pre><h3><a class="nav-anchor" id="Streams-1" href="#Streams-1">Streams</a></h3><p>We can query for all the streams in a collection using the <code>streams</code> function.</p><pre><code class="language-julia">streams(&quot;USGS&quot;)
102-element Array{BTrDB.Stream,1}:
 BTrDB.Stream(&quot;12d7b1e7-a38e-45c0-8959-d3231b254cab&quot;, &quot;BOU_Z&quot;, &quot;USGS/GEOMAG/Boulder&quot;, Dict(&quot;distiller&quot;=&gt;&quot;&quot;,&quot;name&quot;=&gt;&quot;BOU_Z&quot;,&quot;unit&quot;=&gt;&quot;nanotesla&quot;,&quot;ingress&quot;=&gt;&quot;&quot;), Dict{String,Any}(&quot;element&quot;=&gt;&quot;Z&quot;,&quot;elevation&quot;=&gt;&quot;1682&quot;,&quot;latitude&quot;=&gt;&quot;40.137&quot;,&quot;longitude&quot;=&gt;&quot;254.764&quot;,&quot;orientation&quot;=&gt;&quot;HDZF&quot;,&quot;reported&quot;=&gt;&quot;HDZF&quot;,&quot;source&quot;=&gt;&quot;United States Geological Survey&quot;,&quot;station&quot;=&gt;&quot;Boulder&quot;), 0, 0)
 ...</code></pre><p>Although if you already have the UUID, you can retrieve that stream directly using the <code>refresh</code> or the <code>stream_from_uuid</code> function (which is aliased to <code>refresh</code>).  <code>refresh</code> will take either a UUID string or a Stream object.</p><pre><code class="language-julia">refresh(&quot;12d7b1e7-a38e-45c0-8959-d3231b254cab&quot;)
BTrDB.Stream(&quot;12d7b1e7-a38e-45c0-8959-d3231b254cab&quot;, &quot;BOU_Z&quot;, &quot;USGS/GEOMAG/Boulder&quot;, Dict(&quot;distiller&quot;=&gt;&quot;&quot;,&quot;name&quot;=&gt;&quot;BOU_Z&quot;,&quot;unit&quot;=&gt;&quot;nanotesla&quot;,&quot;ingress&quot;=&gt;&quot;&quot;), Dict{String,Any}(&quot;element&quot;=&gt;&quot;Z&quot;,&quot;elevation&quot;=&gt;&quot;1682&quot;,&quot;latitude&quot;=&gt;&quot;40.137&quot;,&quot;longitude&quot;=&gt;&quot;254.764&quot;,&quot;orientation&quot;=&gt;&quot;HDZF&quot;,&quot;reported&quot;=&gt;&quot;HDZF&quot;,&quot;source&quot;=&gt;&quot;United States Geological Survey&quot;,&quot;station&quot;=&gt;&quot;Boulder&quot;), 0, 0)</code></pre><h2><a class="nav-anchor" id="Managing-Stream-Data-1" href="#Managing-Stream-Data-1">Managing Stream Data</a></h2><h3><a class="nav-anchor" id="Inserts-1" href="#Inserts-1">Inserts</a></h3><p>The BTrDB bindings expect an array of <code>Pair</code> objects for insertion into a stream.  The first element of the pair is the <code>Int64</code> timestamp in nanoseconds and the last element is the <code>Float64</code> value.</p><pre><code class="language-julia">data = [
    Pair(1546300801000000000, 1.0),
    Pair(1546300802000000000, 2.0),
    Pair(1546300803000000000, 3.0)
]
s = stream_from_uuid(uuid_token)
insert(s, data)</code></pre><h2><a class="nav-anchor" id="Querying-Stream-Data-1" href="#Querying-Stream-Data-1">Querying Stream Data</a></h2><h3><a class="nav-anchor" id="Raw-Values-Query-1" href="#Raw-Values-Query-1">Raw Values Query</a></h3><p>To retrieve the raw values in a given range of time you can use the <code>values</code> function which accepts a <code>Stream</code> object along with the start and end timestamps (<code>Int64</code>).  This call will return an array of <code>RawPoint</code> objects.</p><pre><code class="language-julia">s = stream_from_uuid(uuid_token)
points = values(s, 1546300802000000000, 1546300804000000000)</code></pre><h3><a class="nav-anchor" id="Windows-Query-1" href="#Windows-Query-1">Windows Query</a></h3><p>To return windowed results, you may choose to use the <code>windows</code> function.  As in similar libraries, this call will provide a summary of values within the provided window size, <code>width</code>, in nanoseconds.  <code>StatPoint</code> objects are returned which contain <code>time</code>, <code>min</code>, <code>mean</code>, <code>max</code>, <code>count</code>, and <code>stddev</code> attributes to describe the aggregated time series points.  The <code>depth</code> argument determines the level of accuracy that is provided as smaller numbers will travel further down into the BTrDB tree data structure (see the <code>BTrDB Explained</code> page for more info).</p><pre><code class="language-julia">start = 1546300800000000000
stop  = 1546300808000000000
width = 2000000000
depth = 20
points = windows(s, start, stop, width, depth)</code></pre><h3><a class="nav-anchor" id="Aligned-Windows-Query-1" href="#Aligned-Windows-Query-1">Aligned Windows Query</a></h3><p>Similar to the <code>windows</code> query but with better performance, there is an <code>aligned_windows</code> function in which the width of the window is determined by the <code>pointwidth</code> argument.  Window size will be determined as a power of 2 using pointwidth as the exponent (2^pointwidth).  If you don&#39;t need precise start/stop times to your windows, then this function is often a better choice than the <code>windows</code> query.</p><p>Just like the <code>windows</code> function, this call will return an array of <code>StatPoint</code> objects.  These objects contain <code>time</code>, <code>min</code>, <code>mean</code>, <code>max</code>, <code>count</code>, and <code>stddev</code> attributes to describe the aggregated time series points.</p><pre><code class="language-julia">s = stream_from_uuid(uuid_token)
start = 1546300800000000000
stop =  1546300808000000000
pointwidth = 20
points = aligned_windows(s, start, stop, pointwidth)</code></pre><footer><hr/><a class="previous" href="../concepts/"><span class="direction">Previous</span><span class="title">Concepts</span></a><a class="next" href="../../lib/types/"><span class="direction">Next</span><span class="title">Types</span></a></footer></article></body></html>
