<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions · BTrDB.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link href="../../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../../"><img class="logo" src="../../assets/logo.png" alt="BTrDB.jl logo"/></a><h1>BTrDB.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../../">Introduction</a></li><li><span class="toctext">User Guide</span><ul><li><a class="toctext" href="../../man/getting_started/">Getting Started</a></li><li><a class="toctext" href="../../man/explained/">BTrDB Explained</a></li><li><a class="toctext" href="../../man/concepts/">Concepts</a></li><li><a class="toctext" href="../../man/sample_usage/">Sample Usage</a></li></ul></li><li><span class="toctext">API</span><ul><li><a class="toctext" href="../types/">Types</a></li><li class="current"><a class="toctext" href>Functions</a><ul class="internal"><li><a class="toctext" href="#Metadata-Retrieval-1">Metadata Retrieval</a></li><li><a class="toctext" href="#Stream-Management-1">Stream Management</a></li><li><a class="toctext" href="#Data-Manipulation-1">Data Manipulation</a></li><li><a class="toctext" href="#Data-Retrieval-1">Data Retrieval</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>API</li><li><a href>Functions</a></li></ul><a class="edit-page" href="https://github.com/PingThingsIO/BTrDB.jl/blob/master/docs/src/lib/functions.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Functions</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Functions-1" href="#Functions-1">Functions</a></h1><ul><li><a href="#BTrDB.aligned_windows"><code>BTrDB.aligned_windows</code></a></li><li><a href="#BTrDB.collections"><code>BTrDB.collections</code></a></li><li><a href="#BTrDB.create"><code>BTrDB.create</code></a></li><li><a href="#BTrDB.delete"><code>BTrDB.delete</code></a></li><li><a href="#BTrDB.earliest"><code>BTrDB.earliest</code></a></li><li><a href="#BTrDB.flush"><code>BTrDB.flush</code></a></li><li><a href="#BTrDB.insert"><code>BTrDB.insert</code></a></li><li><a href="#BTrDB.latest"><code>BTrDB.latest</code></a></li><li><a href="#BTrDB.nearest"><code>BTrDB.nearest</code></a></li><li><a href="#BTrDB.obliterate"><code>BTrDB.obliterate</code></a></li><li><a href="#BTrDB.refresh"><code>BTrDB.refresh</code></a></li><li><a href="#BTrDB.setannotations"><code>BTrDB.setannotations</code></a></li><li><a href="#BTrDB.settags"><code>BTrDB.settags</code></a></li><li><a href="#BTrDB.stream_from_uuid"><code>BTrDB.stream_from_uuid</code></a></li><li><a href="#BTrDB.streams"><code>BTrDB.streams</code></a></li><li><a href="#BTrDB.windows"><code>BTrDB.windows</code></a></li><li><a href="#Base.values"><code>Base.values</code></a></li></ul><h2><a class="nav-anchor" id="Metadata-Retrieval-1" href="#Metadata-Retrieval-1">Metadata Retrieval</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.collections" href="#BTrDB.collections"><code>BTrDB.collections</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">collections()</code></pre><p>Returns an array of all collection strings</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L56-L60">source</a><div><div><pre><code class="language-none">collections(starts_with::String)</code></pre><p>Returns an array of all collection strings that start with a given String</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L66-L70">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.streams" href="#BTrDB.streams"><code>BTrDB.streams</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">streams(collection::String)</code></pre><p>Returns an Array of <code>Stream</code> objects found with the supplied collection.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L84-L88">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.refresh" href="#BTrDB.refresh"><code>BTrDB.refresh</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">refresh(uuid::String)</code></pre><p>Returns a new <code>Stream</code> object with the latest metadata from the server.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L130-L134">source</a><div><div><pre><code class="language-none">refresh(stream::Stream)</code></pre><p>Returns a new <code>Stream</code> object with the latest metadata from the server.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L159-L163">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.stream_from_uuid" href="#BTrDB.stream_from_uuid"><code>BTrDB.stream_from_uuid</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">stream_from_uuid(uuid::String)</code></pre><p>Returns a new <code>Stream</code> object with the latest metadata from the server. Alias for <code>refresh(uuid::String)</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L167-L172">source</a></section><h2><a class="nav-anchor" id="Stream-Management-1" href="#Stream-Management-1">Stream Management</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.create" href="#BTrDB.create"><code>BTrDB.create</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">create(uuid::String, collection::String, tags::Dict{String, String}, annotations::Dict{String, Any})</code></pre><p>Creates a new stream on the server.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L111-L115">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.obliterate" href="#BTrDB.obliterate"><code>BTrDB.obliterate</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">obliterate(uuid::String)</code></pre><p>Deletes a <code>Stream</code> with a given UUID from the server permanently.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L175-L179">source</a><div><div><pre><code class="language-none">obliterate(stream::Stream)</code></pre><p>Deletes a <code>Stream</code> from the server permanently.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L196-L200">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.settags" href="#BTrDB.settags"><code>BTrDB.settags</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">settags(stream::Stream, tags::Dict{String, String})</code></pre><p>Overwrites existing tags.</p><p><strong>Notes</strong></p><p>Tags are used internally by the system and are not generally meant to be manipulated by end users.</p><p>If you would like to add your own custom metadata, please use annotations.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L235-L246">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.setannotations" href="#BTrDB.setannotations"><code>BTrDB.setannotations</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">setannotations(stream::Stream, annotations::Dict{String, Any})</code></pre><p>Overwrites existing annotations.</p><p><strong>Notes</strong></p><p>Stream annotations are provided so that you may store Stream related custom metadata.</p><p>You cannot delete annotations at this time though this will change in a future update.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L263-L275">source</a></section><h2><a class="nav-anchor" id="Data-Manipulation-1" href="#Data-Manipulation-1">Data Manipulation</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.insert" href="#BTrDB.insert"><code>BTrDB.insert</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">insert(uuid::String, data::Array{Pair{Int64, Float64},1})</code></pre><p>Insert new data in the form (time, value) into the series.</p><p>Inserts a list of new (time, value) tuples into the series. The tuples in the list need not be sorted by time. If the arrays are larger than appropriate, this function will automatically chunk the inserts. As a consequence, the insert is not necessarily atomic, but can be used with a very large array.</p><p><strong>Arguments</strong></p><ul><li>uuid : a <code>String</code> for the stream&#39;s unique identifier</li><li>data : an <code>Array</code> of <code>Pair</code> objects representings points where the first pair item is the time (<code>Int64</code>) and the second item is the value (<code>Float64</code>)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L497-L512">source</a><div><div><pre><code class="language-none">insert(stream::Stream, data::Array{Pair{Int64, Float64},1})</code></pre><p>Insert new data in the form (time, value) into the series.</p><p>Inserts a list of new (time, value) tuples into the series. The tuples in the list need not be sorted by time. If the arrays are larger than appropriate, this function will automatically chunk the inserts. As a consequence, the insert is not necessarily atomic, but can be used with a very large array.</p><p><strong>Arguments</strong></p><ul><li>stream : the <code>Stream</code> to use for data insertion</li><li>data : an <code>Array</code> of <code>Pair</code> objects representings points where the first pair item is the time (<code>Int64</code>) and the second item is the value (<code>Float64</code>)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L529-L544">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.delete" href="#BTrDB.delete"><code>BTrDB.delete</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">delete(uuid::String, start::Int64, stop::Int64)</code></pre><p>&quot;Delete&quot; all points between <code>start</code> (inclusive) and <code>end</code> (exclusive), both in nanoseconds. As BTrDB has persistent multiversioning, the deleted points will still exist as part of an older version of the stream.</p><p><strong>Arguments</strong></p><ul><li>uuid : the <code>String</code> UUID of the stream to use for data deletion</li><li>start : the start time (<code>Int64</code>) in nanoseconds for the range to be deleted (inclusive)</li><li>stop : the end time (<code>Int64</code>) in nanoseconds for the range to be deleted (exclusive)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L548-L561">source</a><div><div><pre><code class="language-none">delete(stream::Stream, start::Int64, stop::Int64)</code></pre><p>&quot;Delete&quot; all points between <code>start</code> (inclusive) and <code>end</code> (exclusive), both in nanoseconds. As BTrDB has persistent multiversioning, the deleted points will still exist as part of an older version of the stream.</p><p><strong>Arguments</strong></p><ul><li>stream : the <code>Stream</code> to use for data deletion</li><li>start : the start time (<code>Int64</code>) in nanoseconds for the range to be deleted (inclusive)</li><li>stop : the end time (<code>Int64</code>) in nanoseconds for the range to be deleted (exclusive)</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L577-L590">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.flush" href="#BTrDB.flush"><code>BTrDB.flush</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">flush(uuid::String)</code></pre><p>Forces the database to commit buffered data.  This function is generally not needed by end users.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L204-L209">source</a><div><div><pre><code class="language-none">flush(stream::Stream)</code></pre><p>Forces the database to commit buffered data.  This function is generally not needed by end users.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L226-L231">source</a></section><h2><a class="nav-anchor" id="Data-Retrieval-1" href="#Data-Retrieval-1">Data Retrieval</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.nearest" href="#BTrDB.nearest"><code>BTrDB.nearest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">nearest(stream::Stream, time::Int64, version::Int=0, backward::Bool=false)</code></pre><p>Finds the closest point in the stream to a specified time.</p><p>Return the point nearest to the specified <code>time</code> in nanoseconds since Epoch in the stream with <code>version</code> while specifying whether to search forward or backward in time. If <code>backward</code> is false, the returned point will be &gt;= <code>time</code>. If backward is true, the returned point will be &lt; <code>time</code>. The version of the stream used to satisfy the query is returned.</p><p><strong>Arguments</strong></p><ul><li>stream : The <code>Stream</code> object to search</li><li>time : The <code>Int64</code> time (in nanoseconds since Epoch) to search near</li><li>version : <code>Int64</code> version of the stream to use in search</li><li>backward : <code>boolean</code> (true) to search backwards from time, else false for forward</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L296-L314">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.earliest" href="#BTrDB.earliest"><code>BTrDB.earliest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">earliest(stream::Stream, version::Int=0)</code></pre><p>Returns the first point of data in the stream.</p><p><strong>Arguments</strong></p><ul><li>stream : The <code>Stream</code> object to search</li><li>version : <code>Int64</code> version of the stream to use in search</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L332-L341">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.latest" href="#BTrDB.latest"><code>BTrDB.latest</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">latest(stream::Stream, version::Int=0)</code></pre><p>Returns last point of data in the stream.</p><p><strong>Arguments</strong></p><ul><li>stream : The <code>Stream</code> object to search</li><li>version : <code>Int64</code> version of the stream to use in search</li></ul></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L345-L354">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.values" href="#Base.values"><code>Base.values</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">values(stream::Stream, start::Int64, stop::Int64, version::Int=0)</code></pre><p>Read raw values from BTrDB between time [start, stop) in nanoseconds.</p><p>RawValues queries BTrDB for the raw time series data points between <code>start</code> and <code>end</code> time, both in nanoseconds since the Epoch for the specified stream <code>version</code>.</p><p><strong>Arguments</strong></p><ul><li>start : The start time (<code>Int64</code>) in nanoseconds for the range to be queried (inclusive)</li><li>stop : The end time (<code>Int64</code>) in nanoseconds for the range to be queried (exclusive)</li><li>version : <code>Int64</code> version of the stream to use when querying data</li></ul><p><strong>Notes</strong></p><p>Note that the raw data points are the original values at the sensor&#39;s native sampling rate (assuming the time series represents measurements from a sensor). This is the lowest level of data with the finest time granularity. In the tree data structure of BTrDB, this data is stored in the vector nodes.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L358-L380">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.windows" href="#BTrDB.windows"><code>BTrDB.windows</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">windows(stream::Stream, start::Int64, stop::Int64, width::Int, depth::Int, version::Int=0)</code></pre><p>Read arbitrarily-sized windows of data from BTrDB.  StatPoint objects will be returned representing the data for each window.</p><p><strong>Arguments</strong></p><ul><li>start : The start time (<code>Int64</code>) in nanoseconds for the range to be queried (inclusive)</li><li>stop : The end time (<code>Int64</code>) in nanoseconds for the range to be queried (exclusive)</li><li>version : <code>Int64</code> version of the stream to use when querying data</li><li>width :  the number (<code>Int</code>) of nanoseconds in each window, subject to the depth parameter.</li><li>depth : The precision of the window duration as a power of 2 in nanoseconds. E.g 30 would make the window duration accurate to roughly 1 second</li></ul><p><strong>Notes</strong></p><p>Windows returns arbitrary precision windows from BTrDB. It is slower than AlignedWindows, but still significantly faster than RawValues. Each returned window will be <code>width</code> nanoseconds long. <code>start</code> is inclusive, but <code>end</code> is exclusive (e.g if end &lt; start+width you will get no results). That is, results will be returned for all windows that start at a time less than the end timestamp. If (<code>end</code> - <code>start</code>) is not a multiple of width, then end will be decreased to the greatest value less than end such that (end - start) is a multiple of <code>width</code> (i.e., we set end = start + width * floordiv(end - start, width). The <code>depth</code> parameter is an optimization that can be used to speed up queries on fast queries. Each window will be accurate to 2^depth nanoseconds. If depth is zero, the results are accurate to the nanosecond. On a dense stream for large windows, this accuracy may not be required. For example for a window of a day, +- one second may be appropriate, so a depth of 30 can be specified. This is much faster to execute on the database side.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L395-L427">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="BTrDB.aligned_windows" href="#BTrDB.aligned_windows"><code>BTrDB.aligned_windows</code></a> — <span class="docstring-category">Function</span>.</div><div><div><pre><code class="language-julia">aligned_windows(stream::Stream, start::Int64, stop::Int64, pointwidth::Int, version::Int=0)</code></pre><p>Read statistical aggregates of windows of data from BTrDB.</p><p>Query BTrDB for aggregates (or roll ups or windows) of the time series with <code>version</code> between time <code>start</code> (inclusive) and <code>end</code> (exclusive) in nanoseconds. Each point returned is a statistical aggregate of all the raw data within a window of width 2**<code>pointwidth</code> nanoseconds. These statistical aggregates currently include the mean, minimum, and maximum of the data and the count of data points composing the window.</p><p>Note that <code>start</code> is inclusive, but <code>end</code> is exclusive. That is, results will be returned for all windows that start in the interval [start, end). If end &lt; start+2^pointwidth you will not get any results. If start and end are not powers of two, the bottom pointwidth bits will be cleared. Each window will contain statistical summaries of the window. Statistical points with count == 0 will be omitted.</p><p><strong>Arguments</strong></p><ul><li>start : The start time (<code>Int64</code>) in nanoseconds for the range to be queried (inclusive)</li><li>stop : The end time (<code>Int64</code>) in nanoseconds for the range to be queried (exclusive)</li><li>pointwidth : the number of ns between data points (2**pointwidth)</li><li>version : <code>Int64</code> version of the stream to use when querying data</li></ul><p><strong>Notes</strong></p><p>As the window-width is a power-of-two, it aligns with BTrDB internal tree data structure and is faster to execute than <code>windows()</code>.</p></div></div><a class="source-link" target="_blank" href="https://github.com/PingThingsIO/BTrDB.jl/blob/adb225f0c4b1e80e4e80f152c1e035f1b28b6003/src/BTrDB.jl#L445-L475">source</a></section><footer><hr/><a class="previous" href="../types/"><span class="direction">Previous</span><span class="title">Types</span></a></footer></article></body></html>
